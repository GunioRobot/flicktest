valgrind -v --tool=memcheck --trace-children=yes --track-fds=yes --leak-check=full --log-file=val.txt ./bin/your-binary

opcontrol --setup --vmlinux=/usr/lib/debug/lib/modules/$(uname -r)/vmlinux --separate=cpu
opcontrol --start-daemon
echo starting profiling...
opcontrol --start
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
echo sleeping for 1 min...
sleep 60
opcontrol --stop
echo stopping profiling....

echo generating merged report.....
opreport -l -p /lib/modules/$(uname -r) --merge=all > merged.txt
echo generating separate report.....
opreport -l -p /lib/modules/$(uname -r) > separate.txt


echo generating dump....
opcontrol --dump > dump.txt


echo cleaning up
opcontrol --reset
opcontrol --shutdown

